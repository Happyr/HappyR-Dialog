/* =========================================================
 * HappyR Dialog is based on bootstrap modal by Twitter Inc.
 *
 * Documentation and examples is found at http://developer.happyr.se
 *
 * =========================================================
 * The MIT License (MIT)
 *
 * Copyright (c) 2013 <HappyRecruiting, Twitter Inc>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
 * documentation files (the "Software"), to deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all copies or substantial portions of
 * the Software.
 *
 *  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO
 *  THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
 *  TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 *  SOFTWARE.
 *
 * ========================================================= */
!function($){"use strict";function happyrDialog_convertStringToObject(string){return void 0===string||""===string?{}:JSON.parse(JSON.stringify(eval("("+string+")")))}function happyrDialog_addWrapper(t,i){var o;o=$(".happyr-dialog-body",t).length>0?t.find(".happyr-dialog-body").html():t.html(),t.html(""),t.addClass("happyr-dialog"),i.showHeader&&happyrDialog_addHeader(t,i);var a=$("<div></div>").addClass("happyr-dialog-body").append(o);t.append(a),i.showFooter&&happyrDialog_addFooter(t,i)}function happyrDialog_addHeader(t,i){var o=$("<div></div>").addClass("happyr-dialog-header");if(i.showHeaderTitle&&void 0!==i.texts.title){var a=$("<h3>"+i.texts.title+"</h3>");o.append(a)}if(i.showConfirmButton){var e=$("<button type='button' class='close' data-dismiss='happyr-dialog' aria-hidden='true'>x</button>");o.append(e)}o.append($("<div></div>").addClass("happyr-dialog-clearfix")),t.append(o)}function happyrDialog_addFooter(t,i){var o=$("<div></div>").addClass("happyr-dialog-footer");if(i.showCloseButton){var a=$("<button class='btn' data-dismiss='happyr-dialog' aria-hidden='true'>"+i.texts.close+"</button>");o.append(a)}if(i.showConfirmButton){var e=$("<button class='btn btn-primary'>"+i.texts.confirm+"</button>");e.click(function(){$(document).trigger("happyr-dialog-confirm")}),o.append(e)}t.append(o)}var HappyrDialog=function(t,i){if(this.options=i,this.$element=$(t),this.$element.delegate('[data-dismiss="happyr-dialog"]',"click.dismiss.happyr-dialog",$.proxy(this.hide,this)),this.$element.hide(),happyrDialog_addWrapper(this.$element,i),this.options.remote){var o=this.$element.find(".happyr-dialog-body");void 0!==i.loaderImage&&o.html('<img class="happyr-dialog-loader" src="'+i.loaderImage+'" />'),o.load(this.options.remote,function(){if(i.submitFormOnConfirm){var t=$("form",$(this));t.length>0&&$(document).on("happyr-dialog-confirm",function(){i.getFormResultInDialog?$.ajax({type:t.attr("method"),url:t.attr("action"),data:t.serialize(),success:function(t){o.html(t)}}):i.hideAfterFormSubmit&&(t.submit(),$("#happyr-dialog").happyrDialog("hide"))})}})}};HappyrDialog.prototype={constructor:HappyrDialog,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,i=$.Event("show");this.$element.trigger(i),this.isShown||i.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.backdrop(function(){t.$element.parent().length||t.$element.appendTo(document.body);var i=function(){t.$element.focus().trigger("shown"),$(document).trigger("happyr-dialog-shown")},o=function(){t.$element.show(),t.$element.attr("aria-hidden",!1),t.enforceFocus()};t.options.animate?(t.$element.css("opacity",0).css("top","-25%"),o(),t.$element.animate({top:"10%",opacity:"1"},t.options.animation.timeDialogShow,"swing",i)):(o(),i())}))},hide:function(t){t&&t.preventDefault();var i=this;if(t=$.Event("hide"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()){this.isShown=!1,this.escape(),$(document).off("focusin.happyr-dialog");var o=function(){i.$element.attr("aria-hidden",!0),i.hideDialog()};i.options.animate?i.$element.animate({top:"-25%",opacity:"0"},i.options.animation.timeDialogHide,"swing",o):o()}},enforceFocus:function(){var t=this;$(document).on("focusin.happyr-dialog",function(i){t.$element[0]===i.target||t.$element.has(i.target).length||t.$element.focus()})},escape:function(){var t=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.happyr-dialog",function(i){27==i.which&&t.hide()}):this.isShown||this.$element.off("keyup.dismiss.happyr-dialog")},hideDialog:function(){var t=this;this.$element.hide(),this.backdrop(function(){t.removeBackdrop(),t.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var i=this;this.isShown&&this.options.backdrop?(this.$backdrop=$('<div class="happyr-dialog-backdrop" style="display:none" />').appendTo(document.body),this.$backdrop.click("static"==this.options.backdrop?$.proxy(this.$element[0].focus,this.$element[0]):$.proxy(this.hide,this)),this.options.animation?(this.$backdrop.css("opacity",0),this.$backdrop.show(),this.$backdrop.fadeTo(i.options.animation.timeBackdropShow,i.options.animation.opacityBackdrop,t)):(this.$backdrop.show(),t())):!this.isShown&&this.$backdrop?this.options.animation?this.$backdrop.fadeTo(i.options.animation.timeDialogHide,0,t):t():t&&t()}};var old=$.fn.happyrDialog;$.fn.happyrDialog=function(t){return this.each(function(){var i=$(this),o=i.data("happyrDialog"),a=$.extend(!0,$.fn.happyrDialog.defaults,i.data(),"object"==typeof t&&t);o&&o.isShown||i.data("happyrDialog",o=new HappyrDialog(this,a)),"string"==typeof t?o[t]():void 0!==t.action?o[t.action]():a.show&&o.show()})},$.fn.happyrDialog.defaults={animate:!0,animation:{timeBackdropShow:200,timeBackdropHide:200,timeDialogShow:300,timeDialogHide:300,opacityBackdrop:.8},backdrop:!0,keyboard:!0,show:!0,showHeader:!0,showFooter:!0,showCloseButton:!0,showConfirmButton:!0,showHeaderCloseButton:!0,showHeaderTitle:!0,submitFormOnConfirm:!0,texts:{close:"Close",confirm:"Confirm"},getFormResultInDialog:!0,hideAfterFormSubmit:!1},$.fn.happyrDialog.Constructor=HappyrDialog,$.fn.happyrDialog.noConflict=function(){return $.fn.happyrDialog=old,this},$(document).on("click.happyr-dialog.data-api",'[data-toggle="happyr-dialog"]',function(t){var i=$(this),o=i.attr("href"),a=$(i.attr("data-target")||o&&!o.match(/[?=\/&]/)&&o.replace(/.*(?=#[^\s]+$)/,"")),e=happyrDialog_convertStringToObject(i.attr("data-happyr-dialog-settings"));i.attr("data-happyr-dialog-title")&&(e.texts=$.extend(!0,e.texts,{title:i.attr("data-happyr-dialog-title")})),e=$.extend(!0,{remote:!/#/.test(o)&&o,action:"toggle"},a.data(),i.data(),e),t.preventDefault(),0===a.length&&(a=$("#happyr-dialog"),0===a.length&&(a=$('<div id="happyr-dialog" style="display:none" tabindex="-1" role="dialog" aria-hidden="true" />').appendTo(document.body))),a.happyrDialog(e).one("hide",function(){i.focus()})})}(window.jQuery);