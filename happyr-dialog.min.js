/* =========================================================
 * HappyR Dialog is based on bootstrap modal by Twitter Inc.
 *
 * Documentation and examples is found at http://developer.happyr.se
 *
 * =========================================================
 * The MIT License (MIT)
 *
 * Copyright (c) 2013 <HappyRecruiting, Twitter Inc>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
 * documentation files (the "Software"), to deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all copies or substantial portions of
 * the Software.
 *
 *  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO
 *  THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
 *  TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 *  SOFTWARE.
 *
 * ========================================================= */
!function($){"use strict";function happyrDialog_convertStringToObject(string){return void 0===string||""===string?{}:JSON.parse(JSON.stringify(eval("("+string+")")))}function happyrDialog_addWrapper(t,a){var i;i=$(".happyr-dialog-body",t).length>0?t.find(".happyr-dialog-body").html():t.html(),t.html(""),t.addClass("happyr-dialog"),a.showHeader&&happyrDialog_addHeader(t,a);var o=$("<div></div>").addClass("happyr-dialog-body").append(i);t.append(o),a.showFooter&&happyrDialog_addFooter(t,a)}function happyrDialog_addHeader(t,a){var i=$("<div></div>").addClass("happyr-dialog-header");if(a.showTitle&&void 0!==a.texts.title){var o=$("<h3>"+a.texts.title+"</h3>");i.append(o)}if(a.showButtonHeaderClose){var e=$("<button type='button' class='close' title='"+a.texts.close+"' data-dismiss='happyr-dialog' aria-hidden='true'>x</button>");i.append(e)}i.append($("<div></div>").addClass("happyr-dialog-clearfix")),t.append(i)}function happyrDialog_addFooter(t,a){var i=$("<div></div>").addClass("happyr-dialog-footer"),o=$("<div></div>").addClass("padder");if(a.showButtonClose){var e=$("<button class='btn' data-dismiss='happyr-dialog' aria-hidden='true'>"+a.texts.close+"</button>");o.append(e)}if(a.showButtonConfirm){var n=$("<button class='btn btn-primary'>"+a.texts.confirm+"</button>");n.click(function(){$(document).trigger("happyr-dialog-confirm")}),o.append(n)}i.append(o),t.append(i)}var HappyrDialog=function(t,a){var i=this;if(this.options=a,this.$element=$(t),this.$element.delegate('[data-dismiss="happyr-dialog"]',"click.dismiss.happyr-dialog",$.proxy(this.hide,this)),this.$element.hide(),happyrDialog_addWrapper(this.$element,a),this.options.remote){var o=this.$element.find(".happyr-dialog-body");void 0!==a.loaderImage&&o.html('<img class="happyr-dialog-loader" src="'+a.loaderImage+'" />');var e=function(){if(a.submitFormOnConfirm){i.$element.trigger("ajax-loaded");var t=$("form",i.$element);t.length>0&&$(document).one("happyr-dialog-confirm",function(){a.getFormResultInDialog?$.ajax({type:t.attr("method")?t.attr("method"):"POST",url:t.attr("action"),data:t.serialize(),success:function(t){o.html(t),e()}}):a.hideAfterFormSubmit&&(t.submit(),$("#happyr-dialog").happyrDialog("hide"))})}};$.get(this.options.remote,function(t){o.html(""),o.append(t),e()})}};HappyrDialog.prototype={constructor:HappyrDialog,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,a=$.Event("show");if(this.$element.trigger(a),!this.isShown&&!a.isDefaultPrevented()){this.isShown=!0,this._enableEscape(),t.$element.parent().length||t.$element.appendTo(document.body);var i=function(){t.$element.focus().trigger("shown"),$(document).trigger("happyr-dialog-shown")},o=function(){t.$element.show(),t.$element.attr("aria-hidden",!1),t.enforceFocus()};this._showBackdrop(),t.options.animate?(t.$element.css("opacity",0).css("top","-25%"),o(),t.$element.animate({top:"10%",opacity:"1"},t.options.animation.timeDialogShow,"swing",i)):(o(),i())}},hide:function(t){t&&t.preventDefault();var a=this;if(t=$.Event("hide"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()){this.isShown=!1,this._enableEscape(),$(document).off("focusin.happyr-dialog");var i=function(){a.$element.attr("aria-hidden",!0),a.$element.hide(),a.$element.trigger("hidden")};this._hideBackdrop(),a.options.animate?a.$element.animate({top:"-25%",opacity:"0"},a.options.animation.timeDialogHide,"swing",i):i()}},enforceFocus:function(){var t=this;$(document).on("focusin.happyr-dialog",function(a){t.$element[0]===a.target||t.$element.has(a.target).length||t.$element.focus()})},_enableEscape:function(){var t=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.happyr-dialog",function(a){27==a.which&&t.hide()}):this.isShown||this.$element.off("keyup.dismiss.happyr-dialog")},_showBackdrop:function(){var t=this;this.options.backdrop&&(this.$backdrop=$('<div class="happyr-dialog-backdrop" style="display:none" />').appendTo(document.body),this.$backdrop.click("static"==this.options.backdrop?$.proxy(this.$element[0].focus,this.$element[0]):$.proxy(this.hide,this)),this.options.animate?(this.$backdrop.css("opacity",0),this.$backdrop.show(),this.$backdrop.fadeTo(t.options.animation.timeBackdropShow,t.options.animation.opacityBackdrop)):this.$backdrop.show())},_hideBackdrop:function(){if(this.$backdrop){var t=this,a=function(){t.$backdrop&&t.$backdrop.remove(),t.$backdrop=null};this.options.animate?this.$backdrop.fadeTo(t.options.animation.timeDialogHide,0,a):a()}}},$.extend({happyrDialogSetDefaults:function(t){$.fn.happyrDialog.defaults=$.extend(!0,$.fn.happyrDialog.defaults,t)}});var old=$.fn.happyrDialog;$.fn.happyrDialog=function(t){return this.each(function(){var a=$(this),i=a.data("happyrDialog"),o=$.extend(!0,{},$.fn.happyrDialog.defaults,a.data(),"object"==typeof t&&t);i&&i.isShown||a.data("happyrDialog",i=new HappyrDialog(this,o)),"string"==typeof t?i[t]():void 0!==t&&void 0!==t.action?i[t.action]():o.show&&i.show()})},$.fn.happyrDialog.defaults={animate:!0,animation:{timeBackdropShow:200,timeBackdropHide:200,timeDialogShow:300,timeDialogHide:300,opacityBackdrop:.8},backdrop:!0,keyboard:!0,show:!0,showHeader:!0,showFooter:!0,showButtonClose:!0,showButtonConfirm:!0,showButtonHeaderClose:!0,showTitle:!0,submitFormOnConfirm:!0,texts:{close:"Close",confirm:"Confirm"},getFormResultInDialog:!0,hideAfterFormSubmit:!1},$.fn.happyrDialog.Constructor=HappyrDialog,$.fn.happyrDialog.noConflict=function(){return $.fn.happyrDialog=old,this},$(document).on("click.happyr-dialog.data-api",'[data-toggle="happyr-dialog"]',function(t){var a=$(this),i=a.attr("href"),o=$(a.attr("data-target")||i&&!i.match(/[?=\/&]/)&&i.replace(/.*(?=#[^\s]+$)/,"")),e=happyrDialog_convertStringToObject(a.attr("data-happyr-dialog-settings"));a.attr("data-happyr-dialog-title")&&(e.texts=$.extend(!0,e.texts,{title:a.attr("data-happyr-dialog-title")})),e=$.extend(!0,{remote:!/#/.test(i)&&i,action:"toggle"},o.data(),a.data(),e),t.preventDefault(),0===o.length&&(o=$("#happyr-dialog"),0===o.length&&(o=$('<div id="happyr-dialog" style="display:none" tabindex="-1" role="dialog" aria-hidden="true" />').appendTo(document.body))),o.happyrDialog(e).one("hide",function(){a.focus()})})}(window.jQuery);